<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
    <button onclick="bClick(this)">B</button>
    <button onclick="bClick2(this)">B2</button>
    <button onclick="uClick(this)">U</button>
    <button>C</button>
    <div
        contenteditable
        style="width: 500px; height: 500px; background-color: lightgrey;">

        <h3><span style="color: blue;">312</span><span style="color: red;">32</span>1</h3>
        <h4>3123213</h4>
        31232
        <div>abcdefg</div>
    </div>
    <pre>
        节点编号：   节点名称：
        1   Element
        2   Attribute
        3   Text
        4   CDATA Section
        5   Entity Reference
        6   Entity
        7   Processing Instrucion
        8   Comment
        9   Document
        10  Document Type
        11  Document Fragment
        12  Notation
    </pre>
</body>
<script>
    // current Selection
    var select = getSelection();

    // this Editor
    var rootNode = document.querySelector('div');


    //
    // var clearNode = function(nodeFlag, defaultParent){
    //     var defaultParentList = [];
    //     var childNodeList = [];

    //     for(var i = 0; i < nodeFlag.childNodes.length; i++){
    //         if(nodeFlag.childNodes[i].nodeType === 1){
    //             childNodeList.push(nodeFlag.childNodes[i]);
    //         }
    //         else if(nodeFlag.childNodes[i].nodeType === 3){
    //             defaultParentList.push(defaultParent);
    //         }
    //     }

    //     if(defaultParentList.length != 0) return defaultParent;
    // };


    // start to make style
    var bClick = function(self){
        var range = select.getRangeAt(0);
        text = range.toString();
        var strong = document.createElement('strong');
        var editingFlag = range.cloneContents();
        debugger;
        // clearNode(editingFlag, strong)
        strong.appendChild(editingFlag);
        range.deleteContents();
        range.insertNode(strong);
    };


    //
    var uClick = function(self){
        var range = select.getRangeAt(0);
        text = range.toString();
        var em = document.createElement('em');
        var editingFlag = range.cloneContents();
        em.appendChild(editingFlag, em);
        range.deleteContents();
        range.insertNode(em);
    };


    //
    var bClick2 = function(self){
        var treeWalker = document.createTreeWalker(
          rootNode,
          NodeFilter.SHOW_TEXT
        );

        var nodeList = [];

        while(treeWalker.nextNode()) nodeList.push(treeWalker.currentNode);


        for(var i = 0; i < nodeList.length; i++){
            console.log(nodeList[i]);
        }
    }
</script>
</html>